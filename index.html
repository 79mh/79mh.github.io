<!doctype html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>正在進入...</title>
</head>
<body>
<h5>新網址：https://60mh.cc</h5>
<div>請使用safari瀏覽器進入：https://60mh.cc 重新添加至主屏幕</div>
<button onclick="toNew()" id="toNew" style="display: none;width: 80%;margin:300px auto;line-height: 50px;text-align: center;">進入新網址</button>
<iframe src="https://store.seyoumh.com/store.html" id="store-middle" style="display: none;"></iframe>
<script>
    const toNew = ()=>{
        open(location.href.replace('79mh.cc','60mh.cc'),'_self');
    }
    if(localStorage.IsTo60){
        toNew();
    }
    document.getElementById('store-middle').addEventListener('load',({target})=>{
        if(localStorage.IsTo60){
            return ;
        }
        window.storeMiddle = target.contentWindow;
        const setStorage = (key,data)=>{
            const message = {method:'setStorage',argument:{key, data}};
            window.storeMiddle.postMessage(JSON.stringify(message),'*');
        };
        setTimeout(()=>{
            if(localStorage.User){
                setStorage('User',localStorage.User);
            }
            if(localStorage.SearchHistory){
                setStorage('SearchHistory',localStorage.SearchHistory);
            }
            if(localStorage.ReadProgress){
                setStorage('ReadProgress',localStorage.ReadProgress);
            }
            localStorage.IsTo60 = '1';
            document.querySelector('#toNew').style.display = 'block';
            toNew();
        },200);
    });
</script>
</body>
</html>
